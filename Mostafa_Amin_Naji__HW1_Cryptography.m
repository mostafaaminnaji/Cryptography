%Simulation of HW1, Criptography Cours of DR.Kazemitabar

%All of This Code was Written by Mostafa Amin-Naji  2017/02/18

% For contact me: Mostafa.Amin.Naji@gmail.com
clc
close all
clear

%Read the ciphered text
txt_ciphered=char('loe lprtl ders-dpubmkutfv keyjrjhaiuu og s worfamhoahltju jivoes ohs lvrnmsazld cq seuu bblaiyaa bdiexai bjvutk fpmytkln taete zewwu atk utwk a sltbd jivoes vpsi ao toptio bfldeku cjhoex hlqzhbkas. bdiexai"t kfszlm pfsy ydiuuoej hlqzhbkas bxaex zewwyar dosvz, atk sxaacnls xwye oudjuhtkk bz oyizpnh loe rltuwy ol ahf uvrxlsqgudoug bdwhgieu au tnl cjhoexaeyl. sazlr, jf milaeff outkrfv hnj lihza, juoaofls zyiuzlmobs, jf oiy dosc worpgsswhoh, ionlnzld uzl tgiums yeiaa, b uyizpcbd joswoowut um tiw cimlnèsw jivoes. loe zyiuzlmobs dawhky, hpolvky, oodf pxvvjvld g wrpyyeyziww, yimpd, bfk pxldjuaahse tqztkt fpj zwoaciaug hltxwln ippiwy arwhbtlty. dhbl ps tvw lfvwt hs uzl voneoèjl cowhfj day vrjypngslz vlsiyicwk be nipnhn hhtuaztg iemdhsu pn iaz fomtfwu fomtz lorkl bpgr lg jigjh dks. sjy. niucao thtzpsus iersatg. oe hbiml bpuu tiw aahblb jlczh og lyizoenabs, hbt bvkej h rfhlazpnh "uvutaeskpgt" (hkfq) ao ydiuuo cowhfj hlvoacwas kcesq sezaes. ooexlat ssbkytj sud zyiuzlmobs vkld g miywk pgatfju ol zuckaizbtjgus, hllmszo"y zciwte slaol ahk waullrt vf tmiszptvlpotz cpmsd hl ebkple jhbfnej zinhsy hf sfdlczpnh s uec rez. clyy desw ayvpcbdsy ypnhdl wuydt gy snvru horgzet, cuocu tp tvtn waslpey pn bvcatje, pj argusnaatkk "ovl vf hhne" ssotn wjlo tnl mfkzaml. bfdsayv"s nwahuk timz rkxujjld yarpfn skjusaay lvr pfsy zoe lwf. ay pt jk yerhtjnlle latq ao ylcvjl a yoosl ree whssze, yhy cq h pxlvjgbs vyiwsae ivnwwysgaipf, iersatg"z seztfe day jookpdkyacdf muye twjuxl. gjdiexa vfjuas arjwk tu yeqspr zoe cjvkku cjhoex (jrfsaitn tiw cexuan-npgkuèrf uppnlr jf uitltfwu eonhuwln), hbt, og tazaes ooaz oe eak, tnl cjhoex dat kairs vvduexhbmw ao iyyqlhngsytaz. vkynbe"z wuyk, igdeblr, fnlnzbamdf lkk tp loe uue-uate vhd, b loeuyeuajarsy vfirkhkbtse ippiwy. it h cbwzax jiqzlr, khci dltzlr px ahk hlqzhbka it koilaee ssotn spel natbfj vf vsadwz; fuy eystprl, io s jakzas uppnlr px zhomt uzyek, h wpmsd hlcpel d, h dovdk bkjonw l, y cvumv ieivmf t hnj zo pf. ahk cihwuèrk jiqzlr ivntazty vf twcexhl dslsgy cjhoexz io klqalndw dizo djxmexlnu koila vbdbey.ao ffjrewt, b lhbrl og sspnhbflz cgu bf mzej, aeseld g aacmsa xlcus, cimlnèsw zqahrf, gy voneoèjl tgilf. aa cuusjkas um tiw hlvoacwa wxptuwu oaa txwute ziy lpmkz io vpfllrffa ruds, fsjh gspisiez zhjxaej jyddpcgslz lv tnl lfxa cutpbjld zv tiw wrkcipmz arwhbtlt, ivrswzpuudjfn tu ahf ldetay tae puzsjtse ihetsy cowhfjz. az kigxlrkut qgpnzz io loe kucsqwtovn qjvckzs, uzl cowhfj bskz a eamfkyeol hlvoacwa fxvm pfl ol ahf jvwy. ahf sspnhbfl bskk au whcn wojfa dkweovz ot h rfhlazpnh clycvre. whcn yox kaaxas xaah g rez dltzlr. uzl rktajfkex vf uzl rud hpdks zoe mwatkys b lv z (ou siamtkk osvlr). gstigbgn ahfjl axl txwute ziy cly xvwt koocu, ypm dirs oodf uyl at ehne rezk (kilmeswut gspisiezz) at loexl asw bnoxuf dltzlrt au tnl kfq ztxpnh, zlrk qutl mibl kfqz. dkjrzhaiuu it hlrlvrnwk be nojfn tu ahf jvw ou tiw aahse dgyrkzppfkitn tp loe qly, gaudoug uzl puziuavn um tiw jivoesllxz seullr ou tiaz rud, aov ahku utaug zoe dgsusu"s msier hs uzl prhiollxz. mos weaswlf, au rud l (gjvm rlmpf), ahk jiqzlrzlxu d hpvlask pn ivlveu a, coidz ps zoe gaysz wlbautket mwatky. nfpa wk no ug yoc l (fsgt lktoo), dvcgae uzl cowhfjaeda x xzpcn ps ggbnj pn dgsusu t, uzbs z ps uzl skjoov wlgpnuwet rltuwy. it lihzaeku sjpay zorfw mroldsajh qhsjkri chs uzl foysu lv pailjko a ybcdwzslbl hwuexhl blaair oo loe bpgffèye ippiwy. egyljwy azaadcz rksifv vn quoxdldml og loe vsajfaeda, os mze um a swjomuiasilk dosv hs g rez. chsozkj"k tezooe zhd tv svuo dkweovlnipet. looanh lsziyri xsz tnl fjjzt zv pvtsiyo ao sjcubnu gm tnl aulhcq, pt jk jlkhr uzht zoesw dexl ouzlry dhp olrk hwbjl ol pt. jf limotfwu fomtz xvux, jhbjsey iacthgk dat yvajld jfao hyebcpnm ahf npgkuèrf uppnlr xzln pvho zhlr irpur tndajlls ybbnaatkk a "owd" cowhfj ao zoe kgbrthl px ahk zodalte vf uzl axas. xzln hhbcsne yooxwk tnht uzdaoaet" uppnlr xsz eyzeolparsy kmzt guouzlr xlcswhtovn px ahk cihwuèrk jiqzlr, zowbaaey jhbdsetnee thbhhgf lv bxlal zps ippiwy etjoewk tcpcf, optn rezk vf jpfgwyeta lffntn. Iacthgk zudulejld jf keiyyqlpnm h sbewlk, dhjuo taynfv vuz ao cw ahk wofe "ahk citavn um sjf", iy gsfswk tkunzkvn, kucsqwtkk aduvrjpnh lv tnl kfqdoxk "enasy", zoe gaysz uanw vf zlnoqzot"z wjxl. bgibbyl nkces weprhiowk tnl mflooj oe vkld. yaueals um bbtiaml"s ogaey yewwhl zoau zl hgk utwk tnl mflooj sauwy pailjkoej iy lsziyri, bfk sangfka tnht iw oaj ieff bsoug uzl mkahpv hs khrmq hs.')
%Chang to lowercase If there is a probable Upperrcase letters
txt_ciphered=lower(txt_ciphered);


alphabet = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];
%Remove the marks, symbols and spaces except for the alphabet
j=1;
for i=1:size(txt_ciphered,2)
    if ( (txt_ciphered(i) >= 'a') && (txt_ciphered(i) <= 'z') )
        txt_ciphered_without_symbols(j)=txt_ciphered(i);
        j=j+1;
    end
end
txt_ciphered_without_symbols

%Value of Letter frequency in English
English_Letter_Frequency = [0.0817, 0.0150, 0.0278, 0.0425, 0.1270, 0.0223, 0.0202, 0.0609, 0.0697, 0.0015, 0.0077, 0.0403, 0.0241, 0.0675, 0.0751, 0.0193, 0.0010, 0.0599, 0.0633, 0.0906, 0.0276, 0.0098, 0.0236, 0.0015, 0.0197, 0.0007];
grid on

%Relative Frequency the letters of the English alphabet
figure (1), bar(English_Letter_Frequency)
title('English Relative Letter Frequency')

%Letter frequency in Ciphered Text
Ciphered_Letter_Frequency = histc(txt_ciphered, alphabet)/size(txt_ciphered,2);
figure (2),bar(Ciphered_Letter_Frequency)
title('Ciphered Text Relative Letter Frequency')

%In this section we want to compute every characters of Key
%The first letter Key permutations was measured by this steps: 
% 1- we pick up the 1,8,15, ... of txt_ciphered_without_symbols
% 2- we calculate the histogam (Relative Letter Frequency) for 1th character of key
% 3- we find maximum place of most probably character in histogram
% 4- we calculate distance of maximum probably character from 'e' and add
%    it by 'a' for calculate the first character of key


%1th character of key
j=1;
for i=1:7:size(txt_ciphered_without_symbols,2)
    key_char_1(j)=txt_ciphered_without_symbols(i);
    j=j+1;
end
key_char_1_hist = histc(key_char_1, alphabet)/size(key_char_1,2);
figure (3),bar(key_char_1_hist)
title('1st Key character histogram')
max_position=find(key_char_1_hist==max(key_char_1_hist));
key_character_1=char(mod(((max_position+'a'-1)-'e'),26)+'a');
key_character_1


%2th character of key
j=1;
for i=2:7:size(txt_ciphered_without_symbols,2)
    key_char_2(j)=txt_ciphered_without_symbols(i);
    j=j+1;
end
key_char_2_hist = histc(key_char_2, alphabet)/size(key_char_1,2);
figure (4),bar(key_char_2_hist)
title('2st Key character histogram')
max_position=find(key_char_2_hist==max(key_char_2_hist));
key_character_2=char(mod(((max_position+'a'-1)-'e'),26)+'a');
key_character_2

%3th character of key
j=1;
for i=3:7:size(txt_ciphered_without_symbols,2)
    key_char_3(j)=txt_ciphered_without_symbols(i);
    j=j+1;
end
key_char_3_hist = histc(key_char_3, alphabet)/size(key_char_3,2);
figure (5),bar(key_char_3_hist)
title('3st Key character histogram')
max_position=find(key_char_3_hist==max(key_char_3_hist));
key_character_3=char(mod(((max_position+'a'-1)-'e'),26)+'a');
key_character_3

%4th character of key
j=1;
for i=4:7:size(txt_ciphered_without_symbols,2)
    key_char_4(j)=txt_ciphered_without_symbols(i);
    j=j+1;
end
key_char_4_hist = histc(key_char_4, alphabet)/size(key_char_4,2);
figure (6),bar(key_char_4_hist)
title('4st Key character histogram')
max_position=find(key_char_4_hist==max(key_char_4_hist));
key_character_4=char(mod(((max_position+'a'-1)-'e'),26)+'a');
key_character_4

%5th character of key
j=1;
for i=5:7:size(txt_ciphered_without_symbols,2)
    key_char_5(j)=txt_ciphered_without_symbols(i);
    j=j+1;
end
key_char_5_hist = histc(key_char_5, alphabet)/size(key_char_5,2);
figure (7),bar(key_char_5_hist)
title('5st Key character histogram')
max_position=find(key_char_5_hist==max(key_char_5_hist));
key_character_5=char(mod(((max_position+'a'-1)-'e'),26)+'a');
key_character_5


%6th character of key
j=1;
for i=6:7:size(txt_ciphered_without_symbols,2)
    key_char_6(j)=txt_ciphered_without_symbols(i);
    j=j+1;
end
key_char_6_hist = histc(key_char_6, alphabet)/size(key_char_6,2);
figure (8),bar(key_char_6_hist)
title('6st Key character histogram')
max_position=find(key_char_6_hist==max(key_char_6_hist));
key_character_6=char(mod(((max_position+'a'-1)-'e'),26)+'a');
key_character_6

%7th character of key
j=1;
for i=7:7:size(txt_ciphered_without_symbols,2)
    key_char_7(j)=txt_ciphered_without_symbols(i);
    j=j+1;
end
key_char_7_hist = histc(key_char_7, alphabet)/size(key_char_7,2);
figure (9),bar(key_char_7_hist)
title('7st Key character histogram')
max_position=find(key_char_7_hist==max(key_char_7_hist));
key_character_7=char(mod(((max_position+'a'-1)-'e'),26)+'a');
key_character_7

% we construct the all of 7 characters of key
Key_Final=[key_character_1,key_character_2,key_character_3,key_character_4,key_character_5,key_character_6,key_character_7];

Key_Final



% we repeat Key as long as txt_ciphered_without_symbols lenghts
key_repeated=repmat(Key_Final,[1 floor((size(txt_ciphered_without_symbols,2)/7)+1)]);
key_repeated_modified=key_repeated(1:size(txt_ciphered_without_symbols,2));
key_repeated_modified

%Decrypted code as achived by 
decrypted_text=char(mod((txt_ciphered_without_symbols-key_repeated_modified),26)+'a');
decrypted_text
decrypted_Letter_Frequency = histc(decrypted_text, alphabet)/size(decrypted_text,2);
figure (10),bar(decrypted_Letter_Frequency)
title('decrypted ciphered Text Letter Frequency')

decrypted_text_with_symbols=txt_ciphered;


%Add the marks and spaces except for the alphabet
j=1;
for i=1:size(txt_ciphered,2)
    if ( (txt_ciphered(i) >= 'a') && (txt_ciphered(i) <= 'z') )
        decrypted_text_with_symbols(i)=decrypted_text(j);
        j=j+1;
    end
end

txt_ciphered_without_symbols
decrypted_text_with_symbols


